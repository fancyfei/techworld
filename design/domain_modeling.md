# 领域模型分析与设计

软件开发的本质，是从“问题空间”到“解决方案空间”的转化，那么领域模型，就是“解决方案空间”的架构，通过抽象的模型，为系统带来统一的认知。它将指导我们将复杂的问题进行拆分，找出各部分之间的关联和运作流程，帮助我们解决复杂系统落地遇到的问题。

领域模型首要目标是知识体系、边界、内聚等抽象概念，然后才是性能、架构、分层等概念。在战略上分析和抽象出域、子域、限界上下文等重要概念；在战术层面上提炼实体、值对象、领域服务、领域事件、聚合、工厂、资源库等重要概念。

## 分离不同维度的复杂问题

问题域和问题解决域，是一套通用的问题分析解决方法论，在问题域讨论的就是领域模型的事。

- 问题域，在分析阶段讨论，重点关注领域实体及关系、规则等。
- 问题解决域，在设计及实现阶段讨论，对应着系统模型。

系统的复杂问题归纳分为业务与技术两类，各自处理思路与工具并不相同。使用领域驱动设计时，隔离技术细节，分析阶段时业务逻辑建模，设计阶段再考虑技术实现，可以避免复杂问题叠加。

- 业务复杂度，和业务逻辑相关的问题，如各类规则，业务流程等。
- 技术复杂度，和技术实现细节相关的问题，如复杂的客户端环境，数据存储，网络开销等。

业务逻辑建模应该充分的和业务专家在一起，可以是一线业务人员、项目经理、或软件开发者。建模的过程是技术与业务专家一起讨论出来的。

##  相似性概念的分别

和领域模型有相似性但是作用在不同阶段的概念和关系：

- 领域模型不等于ER，领域模型表示特定业务域业务实体及关系，ER 表示设计阶段数据库实现关系。
- 领域模型和DDD在不同阶段，领域模型是分析阶段的产物，分析是对需求及需求背后相关内容的挖掘。而DDD 领域驱动设计是方法论，是从需求打通到设计阶段，分析业务、设计领域模型、编写代码，这就是领域驱动设计的基本过程。

## 领域模型建模的方法

领域模型是建立在用户需求与业务发展上的，需要在业务上开更多的时间，把业务摸清楚，画出关键的稳定的业务流程，每个流程节点的产物就是业务骨架，找到业务骨架就有了建模的良好基础。

下面列了不同的成熟的方法论：

- 用例分析法，最简单常见的分析方法，大致可以分为获取用例、收集实体、添加关联、添加属性、模型精化几个步骤。
- 四色建模法，一种模型的分析和设计方法，关注某个人的角色在某个地点的角色用某个东西的角色做了某件事情。通过把所有模型分为四种类型，帮助模型做到清晰、可追溯。
- 事件风暴，是一种基于领域驱动设计DDD的业务建模方式，类似头脑风暴快速探索复杂业务领域和对领域建模的实践，简单来说就是谁在何时基于什么做了什么，产生了什么，影响了什么事情。
- DDD，领域驱动设计。

## 一般性步骤

领域建模的总结在网上有个提及比较多，领域建模三字经：找名词、加属性、连关系。 

- 首先找出业务主流程，在这个业务的骨架，找到关键领域对象，以及限界上下文的识别。

- 在主流程基础上继续细化分析子流程，深入找更多的领域对象，属性，以及相互之间关系。
- 抽象，在第二步合并整理，这个过程是不断打磨的过程。

